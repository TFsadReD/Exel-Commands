<div align="center">
<h1>Exel Commands<br>üî¢ –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏</h1>

![Python](https://img.shields.io/badge/Python-3.13+-blue)
</div>

> *To read in English, scroll down*

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–±–æ—Ä –ø–æ–ª–µ–∑–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏ —á–∏—Å–µ–ª –∏ —Å–º–µ—à–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ Python.
–§—É–Ω–∫—Ü–∏–∏ –ø–æ–º–æ–≥–∞—é—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, —Å—É–º–º–∏—Ä–æ–≤–∞—Ç—å, —É—Å—Ä–µ–¥–Ω—è—Ç—å –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏—Ö –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º —É—Å–ª–æ–≤–∏—è–º.
–ò–¥–µ—è –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –±—ã–ª–∞ –≤–∑—è—Ç–∞ –∏–∑ `Exel` –∏ –∫–æ–º–∞–Ω–¥ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–∞–º

---

## üìÇ –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
  - type_query
  - to_number
  - flatten
  - summ_coll
  - average_coll
  - count_if
  - summ_if
  - average_if
  - if_error
- –ü—Ä–∏–º–µ—Ä—ã
- –õ–∏—Ü–µ–Ω–∑–∏—è

---

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîç –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
- üîÑ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫, —á–∏—Å–µ–ª –∏ –±—É–ª–µ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ —á–∏—Å–ª–∞.
- üìö *¬´–í—ã–ø—Ä—è–º–ª–µ–Ω–∏–µ¬ª* –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π (`list`, `tuple`, `set`)
- ‚ûï –°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤
- ‚öñÔ∏è –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ–ª–ª–µ–∫—Ü–∏–π
- ‚úÖ –ü–æ–¥—Å—á—ë—Ç –∏ —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ —É—Å–ª–æ–≤–∏—è–º (`str`, `lambda`, `bool`)
- üéØ –ì–∏–±–∫–æ–µ –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- üß± –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ

---

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
git clone https://github.com/TFsadReD/Exel-Commands.git
```

---

## üõ† –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### `type_query(variable)`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫—É —Å —Ç–∏–ø–æ–º –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π:

```python
type_query(10)        # 'int'
type_query("hello")   # 'str'
```

---

### `to_number(variable)`

–ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –∫ —á–∏—Å–ª—É *(–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)*:

```python
to_number("42")     # 42
to_number("3.14")   # 3.14
to_number(True)     # 1
to_number("false")  # 0
```

---

### `flatten(variable)`

–†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤ –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫:

```python
flatten([1, [2, 3], (4, {5, 6})])
# [1, 2, 3, 4, 5, 6]
```

---

### `summ_coll(*args)`

–°—É–º–º–∏—Ä—É–µ—Ç –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∫–æ–ª–ª–µ–∫—Ü–∏–π:

```python
summ_coll([1, 2], (3, 4))
# 10
```

---

### `average_coll(*args, around=None)`

–í—ã—á–∏—Å–ª—è–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤:

```python
average_coll([1, 2, 3, 4])            # 2.5
average_coll([1, 2, 3, 4], around=2)  # 2.50
```

---

### `count_if(*args, condition=">0")`

–°—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—â–∏—Ö —É—Å–ª–æ–≤–∏—é:

```python
count_if([-2, -1, 0, 1, 2], condition=">0")
# 2

count_if([1, 2, 3], condition=lambda x: x % 2 == 1)
# 2
```

---

### `summ_if(*args, condition=">0")`

–°—É–º–º–∏—Ä—É–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ —É—Å–ª–æ–≤–∏—é:

```python
summ_if([-2, -1, 0, 1, 2], condition=">0")
# 3
```

---

### `average_if(*args, condition=">0", around=None)`

–°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ —É—Å–ª–æ–≤–∏—é:

```python
average_if([-2, -1, 0, 1, 2], condition=">0")
# 1.5
```

---

### `if_error(condition, error=None, returning=None)`

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –≤—ã–ø–æ–ª–Ω–∏–º–æ—Å—Ç—å, –ø—Ä–∏ –æ—à–∏–±–∫–µ –≤—ã–¥–∞–≤–∞—è –∑–Ω–∞—á–µ–Ω–∏–µ, —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤–∞–º–∏:

```python
a = "10"
b = "1f"
—Å = if_error(f"int({a})", "No")
print(c)
# 10
print(if_error(f"int({b})", b))
# 1f
```

---

## üìä –ü—Ä–∏–º–µ—Ä—ã

```python
data = [1, "2", [3, "true", "false"], (4, 5.5)]

print(summ_coll(data))                                # 16.5
print(average_coll(data, around=1))                   # 3.3
print(count_if(data, condition=">=2"))                # 4
print(summ_if(data, condition=lambda x: x % 2 == 1))  # 9
print(average_if(data, condition=True))               # 2.75
```

---

## ‚öñ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π **[Apache-2.0 license](https://github.com/TFsadReD/Exel-Commands#Apache-2.0-1-ov-file)**

---

## üèÜ –ê–≤—Ç–æ—Ä:

- **TFsadReD**

<br><br>

<br><br>

<div align="center">
<h1>Exel Commands<br>üî¢ Utilities for Working with Collections</h1>

![Python](https://img.shields.io/badge/Python-3.13+-blue)

</div>

This repository contains a set of useful functions for working with collections of numbers and mixed data in Python.
The functions help transform data, sum, average, and filter them based on given conditions.
The idea for this project was inspired by `Excel` and its built-in commands.

---

## üìÇ Contents

- Features
- Installation
- Usage
  - type_query
  - to_number
  - flatten
  - summ_coll
  - average_coll
  - count_if
  - summ_if
  - average_if
  - if_error
- Examples
- License

---

## ‚ú® Features

* üîç Detect the type of a variable
* üîÑ Convert strings, numbers, and booleans into numbers
* üìö *Flatten* nested collections (`list`, `tuple`, `set`)
* ‚ûï Sum elements while handling different types
* ‚öñÔ∏è Calculate averages of collections
* ‚úÖ Count and sum elements by condition (`str`, `lambda`, `bool`)
* üéØ Flexible rounding of results
* üß± And much more

---

## ‚öôÔ∏è Installation

Clone the repository:

```bash
git clone https://github.com/TFsadReD/Exel-Commands.git
```

---

## üõ† Usage

### `type_query(variable)`

Returns a string with the type of a variable:

```python
type_query(10)        # 'int'
type_query("hello")   # 'str'
```

---

### `to_number(variable)`

Converts a variable to a number *(if possible)*:

```python
to_number("42")     # 42
to_number("3.14")   # 3.14
to_number(True)     # 1
to_number("false")  # 0
```

---

### `flatten(variable)`

Flattens nested collections into a one-dimensional list:

```python
flatten([1, [2, 3], (4, {5, 6})])
# [1, 2, 3, 4, 5, 6]
```

---

### `summ_coll(*args)`

Sums all elements in collections:

```python
summ_coll([1, 2], (3, 4))
# 10
```

---

### `average_coll(*args, around=None)`

Calculates the average value of elements:

```python
average_coll([1, 2, 3, 4])            # 2.5
average_coll([1, 2, 3, 4], around=2)  # 2.50
```

---

### `count_if(*args, condition=">0")`

Counts the number of elements satisfying a condition:

```python
count_if([-2, -1, 0, 1, 2], condition=">0")
# 2

count_if([1, 2, 3], condition=lambda x: x % 2 == 1)
# 2
```

---

### `summ_if(*args, condition=">0")`

Sums elements by condition:

```python
summ_if([-2, -1, 0, 1, 2], condition=">0")
# 3
```

---

### `average_if(*args, condition=">0", around=None)`

Calculates the average value of elements by condition:

```python
average_if([-2, -1, 0, 1, 2], condition=">0")
# 1.5
```

---

### `if_error(condition, error=None, returning=None)`

Checks the expression for feasibility, returning the value you specified in case of an error:

```python
a = "10"
b = "1f"
—Å = if_error(f"int({a})", "No")
print(c)
# 10
print(if_error(f"int({b})", b))
# 1f
```

---

## üìä Examples

```python
data = [1, "2", [3, "true", "false"], (4, 5.5)]

print(summ_coll(data))                                # 16.5
print(average_coll(data, around=1))                   # 3.3
print(count_if(data, condition=">=2"))                # 4
print(summ_if(data, condition=lambda x: x % 2 == 1))  # 9
print(average_if(data, condition=True))               # 2.75
```

---

## ‚öñ License

This project is distributed under the **[Apache-2.0 license](https://github.com/TFsadReD/Exel-Commands#Apache-2.0-1-ov-file)**

---

## üèÜ Author

* **TFsadReD**
